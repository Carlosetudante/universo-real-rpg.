<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#071428">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>Universo Real â€” RPG de Desenvolvimento Pessoal</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="logo.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="logo.svg">
  <link rel="manifest" href="manifest.json">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <!-- Supabase Client (Auth + Database) -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
  <!-- Splash Screen (Tela de Abertura) -->
  <div id="splashScreen">
    <div class="splash-content">
      <img src="logo.svg" alt="Universo Real Logo" class="splash-logo">
      <h1>Universo Real</h1>
      <div id="splashGreeting" style="font-size: 1.2rem; opacity: 0.8; margin-bottom: 10px; font-weight: 500;">Carregando...</div>
      <div class="loading-bar">
        <div class="loading-progress"></div>
      </div>
    </div>
  </div>

  <div class="stars"></div>
  <div class="container">
    <!-- Tela de Login/Registro -->
    <div class="modal" id="authModal">
      <div class="modal-content">
        <h2 id="authTitle">ğŸ® Entrar no Universo Real</h2>
        <div id="loginForm">
          <div class="form-row">
            <div style="flex:1">
              <label>Email</label>
              <input type="email" id="loginUsername" placeholder="Digite seu email..." autocomplete="email">
            </div>
          </div>
          <div class="form-row">
            <div style="flex:1">
              <label>Senha</label>
              <div class="password-wrapper">
                <input type="password" id="loginPassword" placeholder="Digite sua senha...">
                <button type="button" class="toggle-password" data-target="loginPassword" title="Mostrar senha">ğŸ‘ï¸</button>
              </div>
            </div>
          </div>
          <div style="display:flex; align-items:center; gap:8px; margin-top: 12px;">
            <input type="checkbox" id="rememberUser" style="width: auto; cursor: pointer;">
            <label for="rememberUser" style="margin:0; font-size: 13px; cursor: pointer; opacity: 0.8;">Lembrar meu email</label>
          </div>
          <div style="display:flex; gap:8px; margin-top: 20px;">
            <button class="btn" id="loginBtn">Entrar</button>
            <button class="ghost" id="showRegisterBtn">Criar Conta</button>
            <button class="ghost" id="forgotPasswordBtn" style="font-size: 12px; padding: 8px;">Esqueci a Senha</button>
          </div>
        </div>
        
        <div id="registerForm" class="hidden">
          <div class="form-row">
            <div style="flex:1">
              <label>Email</label>
              <input type="email" id="registerUsername" placeholder="Digite seu email..." autocomplete="email">
              <div id="usernameCheckMsg" class="validation-msg"></div>
            </div>
          </div>
          <div class="form-row">
            <div style="flex:1">
              <label>Senha</label>
              <div class="password-wrapper">
                <input type="password" id="registerPassword" placeholder="Crie uma senha...">
                <button type="button" class="toggle-password" data-target="registerPassword" title="Mostrar senha">ğŸ‘ï¸</button>
              </div>
            </div>
          </div>
          <div class="form-row">
            <div style="flex:1">
              <label>Confirmar Senha</label>
              <div class="password-wrapper">
                <input type="password" id="registerConfirmPassword" placeholder="Repita a senha...">
                <button type="button" class="toggle-password" data-target="registerConfirmPassword" title="Mostrar senha">ğŸ‘ï¸</button>
              </div>
              <div id="passwordMatchMsg" class="validation-msg"></div>
            </div>
          </div>
          <div class="form-row">
            <div style="flex:1">
              <label>Nome do Personagem</label>
              <input type="text" id="registerName" placeholder="Nome do seu herÃ³i...">
            </div>
          </div>
          <div class="form-row">
            <div style="flex:1">
              <label>Classe</label>
              <select id="registerRace">
                <option value="Guerreiro">Guerreiro</option>
                <option value="SÃ¡bio">SÃ¡bio</option>
                <option value="Atleta">Atleta</option>
                <option value="Artista">Artista</option>
                <option value="LÃ­der">LÃ­der</option>
                <option value="Equilibrado">Equilibrado</option>
              </select>
            </div>
          </div>
          <div class="form-row">
            <div style="flex:1">
              <label>Pergunta de SeguranÃ§a</label>
              <input type="text" id="registerQuestion" placeholder="Ex: Nome do primeiro pet?">
            </div>
          </div>
          <div class="form-row">
            <div style="flex:1">
              <label>Resposta de SeguranÃ§a</label>
              <input type="text" id="registerAnswer" placeholder="Sua resposta secreta...">
            </div>
          </div>
          <div class="form-row">
            <div style="flex:1">
              <label>Cor da Aura</label>
              <input type="color" id="registerAura" value="#ffdd57">
            </div>
          </div>
          <div style="display:flex; gap:8px; margin-top: 20px;">
            <button class="btn" id="registerBtn">Criar Personagem</button>
            <button class="ghost" id="showLoginBtn">JÃ¡ tenho conta</button>
          </div>
        </div>

        <!-- Guia de InstalaÃ§Ã£o PWA -->
        <div class="install-guide">
          <h3>ğŸš€ Quer usar como um aplicativo?</h3>
          <p class="small">Tenha acesso rÃ¡pido e offline direto da sua tela inicial!</p>
          
          <button class="ghost" id="installAppBtn" style="display: none; margin-top: 10px; width: 100%; border: 1px solid var(--success); color: var(--success);">ğŸ“² Instalar Aplicativo (Recomendado)</button>

          <div class="install-instructions">
            <div class="install-platform">
              <h4>ğŸ¤– Android (Chrome)</h4>
              <ol>
                <li>Toque no botÃ£o <strong>"Instalar Aplicativo"</strong> acima (se aparecer).</li>
                <li>Ou, no menu do Chrome (â‹®), procure por <strong>"Instalar aplicativo"</strong>.</li>
              </ol>
            </div>
            <div class="install-platform">
              <h4>ğŸ iPhone (Safari)</h4>
              <ol>
                <li>Toque no Ã­cone de <strong>Compartilhar</strong> (um quadrado com uma seta para cima).</li>
                <li>Role para baixo e escolha <strong>"Adicionar Ã  Tela de InÃ­cio"</strong>.</li>
              </ol>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Modal de EdiÃ§Ã£o de Perfil -->
    <div class="modal" id="editProfileModal">
      <div class="modal-content">
        <h2>âœï¸ Editar Perfil</h2>
        <div class="form-row">
          <div style="flex:1">
            <label>Nome do Personagem</label>
            <input type="text" id="editName" placeholder="Nome do seu herÃ³i...">
          </div>
        </div>
        <div class="form-row">
          <div style="flex:1">
            <label>Classe</label>
            <select id="editRace">
              <option value="Guerreiro">Guerreiro</option>
              <option value="SÃ¡bio">SÃ¡bio</option>
              <option value="Atleta">Atleta</option>
              <option value="Artista">Artista</option>
              <option value="LÃ­der">LÃ­der</option>
              <option value="Equilibrado">Equilibrado</option>
            </select>
          </div>
        </div>
        <div class="form-row">
          <div style="flex:1">
            <label>TÃ­tulo</label>
            <select id="editTitle"></select>
          </div>
        </div>
        <div class="form-row">
          <div style="flex:1">
            <label>Cor da Aura</label>
            <input type="color" id="editAura">
          </div>
        </div>
        <div style="display:flex; gap:8px; margin-top: 20px;">
          <button class="btn" id="saveProfileBtn">Salvar AlteraÃ§Ãµes</button>
          <button class="ghost" id="cancelEditBtn">Cancelar</button>
        </div>
      </div>
    </div>

    <!-- Modal de HistÃ³rico de Tarefas -->
    <div class="modal" id="taskHistoryModal">
      <div class="modal-content">
        <h2>ğŸ“œ HistÃ³rico de Tarefas</h2>
        <div id="taskHistoryList" style="max-height: 300px; overflow-y: auto; margin-bottom: 20px;"></div>
        <button class="btn" onclick="document.getElementById('taskHistoryModal').classList.remove('active')">Fechar</button>
      </div>
    </div>

    <!-- Modal de ConfiguraÃ§Ã£o de Grupos Financeiros -->
    <div class="modal" id="groupConfigModal">
      <div class="modal-content">
        <h2>ğŸ§© Configurar Grupos</h2>
        <p class="small" style="margin-bottom: 15px;">Crie grupos para somar gastos automaticamente baseados em palavras-chave na descriÃ§Ã£o.</p>
        <div class="form-row">
          <input type="text" id="groupNameInput" placeholder="Nome (ex: Casa)" style="flex:1">
        </div>
        <div class="form-row">
          <input type="text" id="groupKeywordsInput" placeholder="Palavras-chave (ex: luz, agua, net)" style="flex:1">
        </div>
        <button class="btn" id="addGroupBtn" style="width:100%; margin-bottom:20px;">Adicionar Grupo</button>
        <div id="groupsListConfig" style="max-height: 200px; overflow-y: auto; margin-bottom: 10px;"></div>
        <button class="ghost" id="closeGroupConfigBtn" style="width:100%;">Fechar</button>
      </div>
    </div>

    <!-- Tela Principal do Jogo -->
    <div class="card hidden" id="gameScreen">
      <div class="cinema">
        <div class="logo">
          <svg class="logo-icon" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <linearGradient id="logoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#ffdd57;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#ff9f40;stop-opacity:1" />
              </linearGradient>
            </defs>
            <path d="M50 5 L93 27.5 L93 72.5 L50 95 L7 72.5 L7 27.5 Z" fill="none" stroke="url(#logoGradient)" stroke-width="6" stroke-linejoin="round"/>
            <path d="M58 25 L35 58 L52 58 L45 80 L68 45 L50 45 Z" fill="url(#logoGradient)"/>
          </svg>
          <span>Universo Real</span>
        </div>
        <div class="subtitle">Transforme sua vida em um RPG â€” ganhe XP, suba de nÃ­vel e desbloqueie conquistas reais.</div>
        <div class="stage" id="stage">
          <div class="ring" id="ring"></div>
          <div class="orb" id="orb">
            <div class="inner" id="innerOrb">
              <div id="orbLevel">1</div>
              <div class="level-text">NÃ­vel</div>
            </div>
          </div>
        </div>
        <div class="press-start">
          <div class="control-bar">
            <button class="save-btn" id="saveBtn">ğŸ’¾ Salvar</button>
            <div class="divider-v"></div>
            <button class="icon-btn" id="exportBtn" title="Exportar Backup Completo">ğŸ“¤</button>
            <button class="icon-btn" id="importBtn" title="Importar Backup">ğŸ“¥</button>
            <button class="icon-btn" id="restoreBackupBtn" style="display: none;" title="Restaurar Backup AutomÃ¡tico">â†º</button>
            <button class="icon-btn" id="zenModeBtn" title="Modo Zen">ğŸ§˜</button>
            <button class="icon-btn" id="chatBtn" title="Falar com o OrÃ¡culo">ğŸ¤–</button>
            <button class="icon-btn" id="simpleFinanceBtn" title="FinanÃ§as Simplificadas">ğŸ“Š</button>
            <button class="icon-btn danger" id="logoutBtn" title="Sair">ğŸšª</button>
            <input type="file" id="importFile" accept=".json,application/json" style="display: none;">
          </div>
        </div>
      </div>
      
      <div class="panel">
        <!-- Menu de Abas -->
        <div class="tabs">
          <button class="tab-btn active" data-tab="hero">ğŸ¦¸ HerÃ³i</button>
          <button class="tab-btn" data-tab="quests">ğŸ“œ MissÃµes</button>
          <button class="tab-btn" data-tab="finance">ğŸ’° FinanÃ§as</button>
          <button class="tab-btn" data-tab="social">â¤ï¸ Social</button>
          <button class="tab-btn" data-tab="dom">ğŸ’¼ Trabalho</button>
        </div>

        <!-- ConteÃºdo da Aba: HerÃ³i -->
        <div id="tab-hero" class="tab-content active">
          <h3>ğŸ‘¤ Seu Personagem</h3>
          <div class="hero-card-container">
            <div class="hero-card-header" id="heroCardHeader"></div>
            <div class="hero-card-body">
              <div class="hero-avatar-wrapper">
                <div class="avatar large" id="avatar">ğŸ§‘</div>
                <div class="hero-level-badge">NÃ­vel <span id="level">1</span></div>
              </div>
              <div class="hero-info">
                <div class="hero-identity">
                  <h2 id="previewName">Carregando...</h2>
                  <div class="hero-username" id="previewUsername">@...</div>
                </div>
                <div class="hero-badges">
                  <span class="badge-pill race" id="previewRace">...</span>
                  <span class="badge-pill title" id="previewTitle">...</span>
                </div>
                <div class="hero-visual-badges" id="heroVisualBadges"></div>
                <div class="hero-xp-container">
                  <div class="xp-labels">
                    <span>Progresso de XP</span>
                    <span id="xp" class="xp-value">0 / 100</span>
                  </div>
                  <div class="progress-bar slim">
                    <div class="progress-fill" id="xpProgress" style="width: 0%"></div>
                  </div>
                </div>
              </div>
              <button class="edit-profile-icon" id="editProfileBtn" title="Editar Perfil">âš™ï¸</button>
            </div>
          </div>

          <h3>ğŸ’ª Atributos</h3>
          <div class="section">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
              <div class="small">Pontos disponÃ­veis: <strong id="skillPoints">0</strong></div>
              <button class="ghost" id="resetAttrsBtn" style="padding: 6px 12px; font-size: 12px;">Resetar</button>
            </div>
            <div class="attributes-grid" id="attributesGrid">
              <!-- Atributos serÃ£o gerados dinamicamente -->
            </div>
            <div style="margin-top: 25px; max-width: 350px; margin-left: auto; margin-right: auto;">
              <canvas id="attributesChart"></canvas>
            </div>
          </div>

          <h3>ğŸ“Š HistÃ³rico de XP</h3>
          <div class="section">
            <canvas id="xpChart"></canvas>
          </div>

          <h3>ğŸ† Conquistas</h3>
          <div class="section">
            <div class="achievements-list" id="achievementsList">
              <!-- Conquistas serÃ£o geradas dinamicamente -->
            </div>
          </div>
        </div>

        <!-- ConteÃºdo da Aba: MissÃµes -->
        <div id="tab-quests" class="tab-content">
          <h3>ğŸ¯ MissÃµes DiÃ¡rias</h3>
          <div class="section">
            <div class="small" style="margin-bottom: 12px;">
              Complete missÃµes para ganhar XP e pontos de atributo. Cada dia que vocÃª acessa ganha recompensas!
            </div>
            <div style="display: flex; gap: 8px; flex-direction: column;">
              <button class="btn success" id="claimBtn">ğŸ Reivindicar Recompensa DiÃ¡ria</button>
              <div class="small" style="text-align: center;">
                Ãšltima reivindicaÃ§Ã£o: <strong id="lastClaim">Nunca</strong><br>
                SequÃªncia: <strong id="streakDisplay">0</strong> dias ğŸ”¥
              </div>
            </div>
            
            <div class="progress-bar" style="margin-top: 12px;">
              <div class="progress-fill" id="xpProgress" style="width: 0%"></div>
            </div>
            <div class="small" style="text-align: center; margin-top: 4px;">
              Progresso para o prÃ³ximo nÃ­vel
            </div>
          </div>

          <h3>ğŸ“ Tarefas DiÃ¡rias</h3>
          <div class="section">
            <div class="form-row task-input-row" style="margin-bottom: 12px; gap: 8px;">
              <input type="text" id="taskInput" placeholder="Ex: Beber 2L de Ã¡gua..." style="flex: 2;">
              <button class="ghost" id="viewTaskHistoryBtn" title="Ver HistÃ³rico" style="padding: 10px;">ğŸ“œ</button>
              <button class="btn" id="addTaskBtn" style="padding: 10px; width: auto;">+</button>
            </div>
            <div class="task-list" id="taskList">
              <!-- Tarefas serÃ£o geradas dinamicamente -->
            </div>
          </div>

          <h3>ğŸ“– DiÃ¡rio de GratidÃ£o</h3>
          <div class="section">
            <div class="small" style="margin-bottom: 12px;">Escreva 3 coisas boas do dia para ganhar <strong style="color: var(--accent);">50 XP</strong>!</div>
            <div class="form-row" style="flex-direction: column; gap: 8px;">
              <input type="text" id="gratitude1" placeholder="1. Sou grato por...">
              <input type="text" id="gratitude2" placeholder="2. (Opcional)">
              <input type="text" id="gratitude3" placeholder="3. (Opcional)">
              <button class="btn info" id="gratitudeBtn">ğŸ™ Registrar GratidÃ£o</button>
            </div>
            <div id="gratitudeHistory" style="margin-top: 15px; max-height: 200px; overflow-y: auto; padding-right: 5px;"></div>
          </div>

          <h3>ğŸ’ InventÃ¡rio</h3>
          <div class="section">
            <div class="form-row" style="margin-bottom: 12px;">
              <input type="text" id="inventoryInput" placeholder="Nome do item..." style="flex: 1;">
              <button class="btn" id="addItemBtn" style="padding: 10px; width: auto;">+</button>
            </div>
            <div class="inventory-list" id="inventoryList">
              <!-- Itens serÃ£o gerados dinamicamente -->
            </div>
            <div class="small" id="inventoryCount" style="margin-top: 8px; text-align: right; opacity: 0.7;">0 itens</div>
          </div>

        </div>

        <!-- ConteÃºdo da Aba: FinanÃ§as -->
        <div id="tab-finance" class="tab-content">
          <h3>ğŸ’° Controle Financeiro</h3>
          <div class="section">
            <div style="text-align: center; margin-bottom: 20px;">
              <div class="small" style="opacity: 0.7;">Saldo Atual</div>
              <div id="financeBalance" style="font-size: 2em; font-weight: 700;">R$ 0,00</div>
            </div>
            <div class="form-row">
              <div style="flex: 2;">
                <input type="text" id="financeDesc" placeholder="DescriÃ§Ã£o (ex: SalÃ¡rio, Mercado)">
              </div>
              <div style="flex: 1;">
                <input type="text" inputmode="decimal" id="financeValue" placeholder="R$ 0,00">
              </div>
            </div>
            <div class="form-row" style="margin-top: 8px;">
              <select id="financeType" style="flex: 1;">
                <option value="expense">Despesa</option>
                <option value="income">Receita</option>
              </select>
              <select id="financeCategory" style="flex: 1;">
                <option value="Outros">Outros</option>
                <option value="AlimentaÃ§Ã£o">AlimentaÃ§Ã£o</option>
                <option value="Transporte">Transporte</option>
                <option value="Lazer">Lazer</option>
                <option value="Contas">Contas</option>
                <option value="SalÃ¡rio">SalÃ¡rio</option>
                <option value="Extra">Extra</option>
              </select>
              <button class="btn" id="addFinanceBtn" style="width: auto;">+</button>
            </div>

            <!-- Meta Financeira -->
            <div style="margin-top: 20px; margin-bottom: 10px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 15px;">
              <div class="form-row">
                <input type="text" inputmode="decimal" id="financeGoalInput" placeholder="Definir Meta (R$)" style="flex: 2;">
                <button class="btn" id="setFinanceGoalBtn" style="flex: 1;">Definir Meta</button>
              </div>
              <div id="financeGoalDisplay" class="hidden" style="margin-top: 10px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                  <span class="small">Progresso</span>
                  <span class="small" id="financeGoalText">0%</span>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" id="financeGoalProgress" style="width: 0%; background: var(--success);"></div>
                </div>
                <div class="small" style="text-align: center; margin-top: 4px; opacity: 0.7;" id="financeGoalStatus">Faltam R$ 0,00</div>
              </div>
            </div>

            <div class="finance-list" id="financeList">
              <!-- TransaÃ§Ãµes serÃ£o geradas dinamicamente -->
            </div>
          </div>

          <h3>ğŸ“Š GrÃ¡ficos</h3>
          <div class="section">
            <h4 style="text-align: center; margin-bottom: 15px;">Despesas por Categoria</h4>
            <div style="max-width: 300px; margin: 0 auto 25px auto;">
              <canvas id="financeChart"></canvas>
            </div>
            <div style="height: 250px;">
              <canvas id="financeMonthlyChart"></canvas>
            </div>
          </div>

          <h3>ğŸ§© AnÃ¡lise por Grupos</h3>
          <div class="section">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
              <div class="small">Gastos agrupados por palavras-chave</div>
              <button class="ghost" id="configGroupsBtn" style="font-size:12px; padding: 4px 10px;">âš™ï¸ Configurar</button>
            </div>
            <div id="financeGroupsDisplay" style="display: flex; flex-direction: column; gap: 8px;"></div>
          </div>

          <h3>ğŸ“… Contas a Pagar</h3>
          <div class="section">
            <div class="form-row">
              <div style="flex: 2;">
                <input type="text" id="billDesc" placeholder="Conta (ex: Internet, Luz)">
              </div>
              <div style="flex: 1;">
                <input type="text" inputmode="decimal" id="billValue" placeholder="R$ 0,00">
              </div>
            </div>
            <div class="form-row" style="margin-top: 8px;">
              <div style="flex: 1;">
                <input type="date" id="billDate">
              </div>
              <div style="flex: 1;">
                <select id="billRecurrence">
                  <option value="none">Ãšnica</option>
                  <option value="monthly">Mensal</option>
                  <option value="weekly">Semanal</option>
                  <option value="yearly">Anual</option>
                </select>
              </div>
              <button class="btn" id="addBillBtn" style="width: auto;">Agendar</button>
            </div>
            <div class="bill-list" id="billList" style="margin-top: 12px;">
              <!-- Contas serÃ£o geradas dinamicamente -->
            </div>
          </div>
        </div>


        <!-- ConteÃºdo da Aba: Social -->
        <div id="tab-social" class="tab-content">
          <h3>â¤ï¸ Contador de Relacionamento</h3>
          <div class="section">
            <div id="relationshipSetup">
              <div class="small" style="margin-bottom: 8px;">Defina a data de inÃ­cio:</div>
              <div class="form-row">
                <input type="datetime-local" id="relationshipDateInput">
              </div>
              <div class="small" style="margin-bottom: 8px; margin-top: 8px;">Foto do Casal (Opcional):</div>
              <div class="form-row">
                <input type="file" id="relationshipPhotoInput" accept="image/*">
              </div>
              <button class="btn" id="setRelationshipBtn" style="width: 100%; margin-top: 12px;">Iniciar</button>
            </div>
            <div id="relationshipDisplay" class="hidden">
              <img id="relationshipPhotoDisplay" src="" title="Clique para alterar a foto" style="width: 100px; height: 100px; border-radius: 50%; margin: 0 auto 12px auto; display: none; object-fit: cover; border: 2px solid rgba(255, 255, 255, 0.2);">
              <input type="file" id="updateRelationshipPhotoInput" accept="image/*" style="display: none;">
              <div style="text-align: center; font-weight: 700; font-size: 1.1em; margin-bottom: 8px; line-height: 1.4;" id="relationshipTimer">Carregando...</div>
              <div class="small" style="text-align: center; opacity: 0.7;">Juntos nessa jornada!</div>
              <button class="ghost" id="resetRelationshipBtn" style="width: 100%; margin-top: 12px; font-size: 12px;">Resetar Data</button>
            </div>
          </div>
        </div>

        <!-- ConteÃºdo da Aba: Trabalho -->
        <div id="tab-dom" class="tab-content">
          <!-- Tela de ConfiguraÃ§Ã£o (Aparece se nÃ£o tiver trabalho definido) -->
          <div id="workSetupSection" class="section hidden">
            <h3>ğŸ’¼ Configurar Novo Trabalho</h3>
            <p class="small" style="margin-bottom: 15px;">Defina sua empresa e o tipo de atividade para personalizar sua experiÃªncia.</p>
            
            <div class="form-row">
              <div style="flex:1">
                <label>Nome da Empresa / NegÃ³cio</label>
                <input type="text" id="jobNameInput" placeholder="Ex: Pizzaria do ZÃ©, Uber, Minha Loja...">
              </div>
            </div>
            
            <div class="form-row">
              <div style="flex: 1;">
                <label>Tipo de Atividade</label>
                <select id="jobTypeSelect">
                  <option value="pizzaria">ğŸ• Pizzaria (ProduÃ§Ã£o de Massas)</option>
                  <option value="vendedor">ğŸ¤ Vendedor (ComissÃµes)</option>
                  <option value="motorista">ğŸš– Motorista (Corridas)</option>
                  <option value="freelancer">ğŸ’» Freelancer (Projetos/Horas)</option>
                </select>
              </div>
            </div>
            
            <button class="btn success" id="saveJobBtn" style="width:100%; margin-top:10px;">ComeÃ§ar Jornada</button>
          </div>

          <!-- Painel de Trabalho (Aparece quando configurado) -->
          <div id="workDashboardSection" class="hidden">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
              <h3 id="workTitleDisplay" style="margin:0; font-size: 1.2rem;">ğŸ’¼ Trabalho</h3>
              <button class="ghost" id="configJobBtn" style="font-size:12px; padding:4px 8px;">âš™ï¸ Configurar</button>
            </div>

            <div class="work-dashboard-grid">
              <!-- CronÃ´metro Simples -->
              <div class="timer-card">
                <div id="workTimerDisplay" class="digital-clock">00:00:00</div>
                <div style="display: flex; gap: 15px; justify-content: center;">
                  <button id="startWorkBtn" class="btn success" style="min-width: 140px; font-weight: 800; letter-spacing: 0.5px;">â–¶ INICIAR</button>
                  <button id="stopWorkBtn" class="btn danger" style="min-width: 140px; font-weight: 800; letter-spacing: 0.5px;" disabled>â¹ FINALIZAR</button>
                </div>
              </div>
              
              <!-- HistÃ³rico de Ponto (Separado) -->
              <div>
                <div class="history-section-title">â±ï¸ Ãšltimos Registros de Ponto</div>
                <div id="workTimeHistoryList" style="max-height: 150px; overflow-y: auto;"></div>
              </div>
              
              <!-- Ãrea de Singularidade (DinÃ¢mica por Tipo de Trabalho) -->
              <div id="workSingularityContainer">
                <!-- Injetado via JS -->
              </div>
              
              <!-- HistÃ³rico de ProduÃ§Ã£o (Separado) -->
              <div>
                <div class="history-section-title">ğŸ“Š HistÃ³rico de ProduÃ§Ã£o</div>
                <div id="workProductionHistoryList" style="max-height: 200px; overflow-y: auto;"></div>
              </div>

              <!-- GrÃ¡fico -->
              <div style="height: 200px; background: rgba(0,0,0,0.2); border-radius: 12px; padding: 15px;">
                <canvas id="workChart"></canvas>
              </div>
            </div>
          </div>
        </div>

        <div class="small" style="margin-top: auto; text-align: center;">
          Seus dados sÃ£o salvos no servidor. Acesse de qualquer dispositivo!
        </div>
      </div>
    </div>
  </div>
  
  <!-- FAB (BotÃ£o Flutuante de AÃ§Ãµes RÃ¡pidas) -->
  <div class="fab-container hidden" id="fabContainer">
    <div class="fab-actions hidden" id="fabActions">
      <button class="fab-action" id="fabWorkBtn" title="Registrar Ponto">ğŸ’¼</button>
      <button class="fab-action" id="fabTaskBtn" title="Adicionar Tarefa">ğŸ“</button>
      <button class="fab-action" id="fabFinanceBtn" title="Nova TransaÃ§Ã£o">ğŸ’°</button>
    </div>
    <button class="fab-main" id="fabMainBtn">â•</button>
  </div>

  <!-- Modal do Chat (OrÃ¡culo) - Sistema Inteligente -->
  <div id="chatModal" class="modal">
    <div class="oracle-container">
      <!-- Header do OrÃ¡culo -->
      <div class="oracle-header">
        <div class="oracle-header-left">
          <div class="oracle-avatar">
            <div class="oracle-avatar-ring"></div>
            <span id="oracleAvatarEmoji">ğŸ¤–</span>
          </div>
          <div class="oracle-info">
            <h2 id="oracleTitle">OrÃ¡culo</h2>
            <div class="oracle-status">
              <span class="oracle-status-dot"></span>
              <span id="oracleStatusText">Online â€¢ Pronto para ajudar</span>
            </div>
          </div>
        </div>
        <div class="oracle-header-right">
          <select id="oraclePersonalitySelect" class="oracle-personality-select">
            <option value="assistant">ğŸ§  Assistente</option>
            <option value="wise">ğŸ§™â€â™‚ï¸ SÃ¡bio</option>
            <option value="coach">ğŸ‹ï¸ Coach</option>
            <option value="friend">ğŸ˜Š Amigo</option>
          </select>
          <button class="oracle-close-btn" id="closeChatBtn" title="Fechar">âœ•</button>
        </div>
      </div>

      <!-- SugestÃµes RÃ¡pidas -->
      <div class="oracle-quick-actions" id="oracleQuickActions">
        <button class="oracle-quick-btn" data-action="status">ğŸ“Š Meu Status</button>
        <button class="oracle-quick-btn" data-action="tasks">ğŸ“ Tarefas</button>
        <button class="oracle-quick-btn" data-action="finance">ğŸ’° FinanÃ§as</button>
        <button class="oracle-quick-btn" data-action="work">ğŸ’¼ Trabalho</button>
        <button class="oracle-quick-btn" data-action="help">â“ Ajuda</button>
      </div>

      <!-- Ãrea de Mensagens -->
      <div id="chatMessages" class="oracle-messages"></div>

      <!-- Ãrea de DigitaÃ§Ã£o -->
      <div class="oracle-input-area">
        <div class="oracle-input-wrapper">
          <button class="oracle-voice-btn" id="oracleVoiceBtn" title="Falar com o OrÃ¡culo">
            <span class="voice-icon">ğŸ¤</span>
            <span class="voice-listening hidden">ğŸ”´</span>
          </button>
          <input type="text" id="chatInput" class="oracle-input" placeholder="Digite sua mensagem ou use comandos como 'criar tarefa...'">
          <button class="oracle-send-btn" id="sendMessageBtn" title="Enviar">
            <span>â¤</span>
          </button>
        </div>
        <div class="oracle-input-hints">
          <span>ğŸ’¡ <strong>Clique duplo</strong> no ğŸ¤ para <strong>modo conversa por voz</strong> â€¢ Exemplo: "gastei 50 no almoÃ§o"</span>
        </div>
      </div>

      <!-- Footer com info de memÃ³ria -->
      <div class="oracle-footer">
        <div class="oracle-memory-indicator" id="oracleMemoryIndicator">
          <span class="memory-icon">ğŸ§ </span>
          <span class="memory-text">MemÃ³ria: <span id="oracleMemoryCount">0</span> aprendizados</span>
        </div>
        <button class="oracle-settings-btn" id="oracleSettingsBtn" title="ConfiguraÃ§Ãµes">âš™ï¸</button>
      </div>
    </div>
  </div>

  <div id="toast" class="toast" style="display:none"></div>

  <!-- Overlay Modo Zen -->
  <div id="zenModeOverlay" class="hidden">
    <img id="zenBackgroundDisplay" class="zen-bg-thumb hidden" alt="Fundo Zen">
    <div class="breathing-orb" id="zenBreathingOrb"></div>
    <div class="zen-content">
      <div id="zenTimer">0 anos, 0 meses, 0 dias...</div>
      <div id="zenQuote">"Frase inspiradora..."</div>
      <div style="display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;">
        <button class="ghost" id="zenMusicBtn" style="font-size: 12px; opacity: 0.7;">ğŸµ Selecionar Pasta de MÃºsicas</button>
        <select id="zenTrackSelect" class="ghost" style="display: none; font-size: 12px; opacity: 0.9; max-width: 250px; cursor: pointer; background: rgba(0,0,0,0.5); width: auto; padding: 8px;"></select>
        <button class="ghost" id="zenImageBtn" style="font-size: 12px; opacity: 0.7;">ğŸ–¼ï¸ Imagem de Fundo</button>
        <button class="ghost" id="zenBreathingBtn" style="font-size: 12px; opacity: 0.7;">ğŸŒ¬ï¸ RespiraÃ§Ã£o</button>
        <button class="ghost" id="zenToggleHudBtn" style="font-size: 12px; opacity: 0.7;">ğŸ‘ï¸ Ocultar Interface</button>
      </div>
      <div id="zenPlaylistInfo" class="small" style="width: 100%; text-align: center; opacity: 0.6; margin-top: -10px;"></div>
      <input type="file" id="zenMusicInput" accept="audio/*" webkitdirectory directory multiple style="display: none;">
      <input type="file" id="zenImageInput" accept="image/*" style="display: none;">
      <audio id="zenAudio"></audio>
      <button class="ghost" id="exitZenBtn">Sair do Modo Zen</button>
    </div>
  </div>

  <!-- Supabase Service (antes do app.js) -->
  <script src="supabase.js"></script>
  <script src="app.js"></script>
  <!-- Sistema de Timer de Trabalho em Segundo Plano -->
  <script src="workTimer.js"></script>